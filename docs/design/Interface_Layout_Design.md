# FlexToDo 界面布局设计方案

## 1. 整体布局架构

### 1.1 三层式界面设计
```
最小化状态 → 预览状态 → 详细状态
   (30px)      (200x100)    (300x400)
     ↓           ↓           ↓
   图标显示    快速预览    完整功能
```

### 1.2 布局响应层级
- **Level 1**: 系统托盘级别 - 最小化圆形图标
- **Level 2**: 桌面悬浮级别 - 预览卡片
- **Level 3**: 应用窗口级别 - 完整界面

## 2. 最小化状态设计 (30x30px)

### 2.1 视觉规格
```
容器规格:
- 尺寸: 30×30px 圆形
- 位置: 屏幕右下角，距边缘 20px
- 背景: 径向渐变 #2563EB → #1D4ED8
- 透明度: 70% (30%透明)
- 阴影: 0 2px 8px rgba(37, 99, 235, 0.4)
```

### 2.2 图标设计
```
主图标:
- 尺寸: 16×16px
- 颜色: #FFFFFF
- 设计: 简化的待办清单图标
- 描边: 1.5px
```

### 2.3 状态指示
```
任务数量徽章:
- 位置: 右上角 (-2px, -2px)
- 尺寸: 14×14px 圆形
- 背景: #DC2626 (红色)
- 文字: 白色, 9px, 粗体
- 最大显示: 99+
```

### 2.4 交互状态
```css
/* 默认状态 */
.minimized-default {
  transform: scale(1);
  filter: blur(0);
}

/* 悬浮状态 */
.minimized-hover {
  transform: scale(1.1);
  box-shadow: 0 4px 16px rgba(37, 99, 235, 0.6);
  transition: all 0.2s ease-out;
}

/* 点击状态 */
.minimized-active {
  transform: scale(0.95);
  transition: all 0.1s ease-in;
}
```

## 3. 预览状态设计 (200×100px)

### 3.1 整体容器
```
容器规格:
- 尺寸: 200×100px
- 圆角: 12px
- 背景: rgba(255, 255, 255, 0.85) + backdrop-blur(10px)
- 边框: 1px solid rgba(255, 255, 255, 0.3)
- 阴影: 0 8px 32px rgba(0, 0, 0, 0.12)
- 定位: 相对最小化图标展开
```

### 3.2 头部区域 (200×24px)
```
┌─────────────────────────────────┐
│ 📋 今日待办 (3)          [⚙️] │
└─────────────────────────────────┘

布局说明:
- 左侧: 图标(14px) + 标题(12px) + 数量徽章
- 右侧: 设置按钮(16px)
- 背景: rgba(37, 99, 235, 0.05)
- 高度: 24px
- 内边距: 8px 12px
```

### 3.3 任务列表区域 (280px宽度)
```
┌───────────────────────────────┐
│█│☐ 紧急项目汇报      14:00 │ ← 红色边条
│█│☐ 团队会议         16:30 │ ← 橙色边条
│█│☐ 代码审查         待定  │ ← 黄色边条
└───────────────────────────────┘

每个任务项:
- 高度: 40px
- 间距: 2px
- 左侧: 紧急程度条(4px) + 复选框(16px) + 文字
- 右侧: 时间信息
- 交互: 仅在交互模式下可点击
```

### 3.4 快速添加区域 (280px宽度)
```
┌───────────────────────────────┐
│ + 添加新任务...              │
└───────────────────────────────┘

布局说明:
- 内容: "+" 符号 + 快速添加输入框
- 交互: 仅在交互模式下可用
- 高度: 32px
- 背景: rgba(37, 99, 235, 0.05)
- 回车保存，ESC取消
```

## 4. 状态切换机制

### 4.1 二元状态切换
FlexToDo采用简化的二元状态设计：

```
状态A: 背景穿透模式 (0.7透明度)
- 完整任务列表可见
- 鼠标完全穿透，无交互
- Win32点击穿透实现

状态B: 交互模式 (0.95透明度)  
- 相同界面布局，恢复交互
- 支持所有鼠标操作
- 可编辑、完成、添加任务
```

### 4.2 切换触发方式
- **热键切换**: Ctrl+Alt+Space
- **ESC返回**: 从交互模式返回穿透模式
- **自动返回**: 10秒无操作自动返回穿透模式
- **失焦返回**: 点击其他应用自动返回穿透模式

### 4.3 状态指示
- **系统托盘图标**: 蓝色圆点(正常) / 红色感叹号(有紧急任务)
- **窗口透明度**: 直观显示当前状态
- **光标变化**: 交互模式下鼠标指针正常，穿透模式下无指针反应

## 5. 布局自适应规则

### 5.1 屏幕边缘检测
```
边缘安全距离:
- 上边缘: 40px (避开系统通知)
- 右边缘: 20px (避开滚动条)
- 下边缘: 40px (避开任务栏)
- 左边缘: 20px
```

### 5.2 展开方向逻辑
```
if (屏幕右侧空间 < 220px) {
    向左展开预览状态
}

if (屏幕下方空间 < 120px) {
    向上展开预览状态
}

if (屏幕空间 < 320×420px) {
    启用紧凑模式
}
```

### 5.3 DPI缩放适配
```
100% DPI: 使用原始尺寸
125% DPI: 所有尺寸 × 1.25
150% DPI: 所有尺寸 × 1.5
200% DPI: 所有尺寸 × 2.0

字体保持相对清晰度
图标使用矢量格式
```

## 6. 网格系统

### 6.1 基础网格
```
基准单位: 4px
间距倍数: 4, 8, 12, 16, 20, 24, 32px
组件高度: 20, 24, 32, 40, 48, 56px
内边距: 8, 12, 16px
```

### 6.2 垂直节奏
```
小组件间距: 8px
中组件间距: 16px
大组件间距: 24px
区域间距: 32px
```

## 7. 组件层级关系

### 7.1 Z-index层级
```css
.minimized-icon { z-index: 9999; }
.preview-panel { z-index: 9998; }
.detailed-window { z-index: 9997; }
.dropdown-menu { z-index: 9996; }
.tooltip { z-index: 9995; }
```

### 7.2 焦点管理
- 详细状态获得焦点时，预览状态自动隐藏
- 点击外部区域时，返回上一级状态
- ESC键逐级返回到最小化状态

## 8. 特殊场景布局

### 8.1 空状态设计
```
无任务时显示:
- 插图: 简单的空状态图标
- 文案: "还没有任务，点击添加第一个吧!"
- 操作: 醒目的添加按钮
```

### 8.2 加载状态
```
数据加载时:
- 骨架屏动画
- 脉冲效果
- 加载进度指示
```

### 8.3 错误状态
```
网络错误时:
- 错误图标
- 简短错误说明
- 重试按钮
```

## 9. 布局实现建议

### 9.1 WPF布局容器选择
```xml
<!-- 最小化状态 -->
<Ellipse />

<!-- 预览状态 -->
<Border CornerRadius="12">
  <StackPanel />
</Border>

<!-- 详细状态 -->
<Grid>
  <Grid.RowDefinitions>
    <RowDefinition Height="32"/>  <!-- 标题栏 -->
    <RowDefinition Height="36"/>  <!-- 搜索 -->
    <RowDefinition Height="32"/>  <!-- 筛选 -->
    <RowDefinition Height="*"/>   <!-- 主内容 -->
    <RowDefinition Height="40"/>  <!-- 添加 -->
    <RowDefinition Height="20"/>  <!-- 状态栏 -->
  </Grid.RowDefinitions>
</Grid>
```

### 9.2 响应式布局实现
```csharp
// 动态计算最佳展开位置
private Point CalculateOptimalPosition(Size contentSize)
{
    var workingArea = SystemParameters.WorkArea;
    var currentPos = this.PointToScreen(new Point(0, 0));
    
    // 计算最佳位置逻辑
    return optimalPosition;
}
```

---

这个界面布局设计方案提供了详细的尺寸规格和实现建议，确保FlexToDo在不同状态下都能提供最佳的用户体验。